import{g as V,f as A,r as u,s as L,_ as w,l as D,m as B,j as e,o as z,p as F,aV as X,ao as Z,az as v,B as C,V as $,Z as J,u as Q,K as ee}from"./index.js";import{W as te}from"./connection2.js";import{$ as se,e as ae}from"./react-photo-view.module.js";import{P as le}from"./index34.js";import{b as re}from"./index36.js";import{r as ne}from"./createSvgIcon2.js";import{d as oe}from"./dayjs.min.js";import{h as b}from"./moment.js";import{q as ie}from"./transition.js";import{a as de}from"./apiBaseEndPoints.js";import{G as S}from"./Grid.js";import{T as ce,a as me}from"./Tabs.js";import"./createSvgIcon.js";import"./resolveComponentProps.js";import"./render.js";import"./use-flags.js";import"./open-closed.js";import"./useTheme.js";import"./useSlotProps.js";import"./KeyboardArrowRight.js";function xe(t){return V("MuiImageList",t)}A("MuiImageList",["root","masonry","quilted","standard","woven"]);const ue=u.createContext({}),W=ue,he=["children","className","cols","component","rowHeight","gap","style","variant"],pe=t=>{const{classes:l,variant:n}=t;return F({root:["root",n]},xe,l)},fe=L("ul",{name:"MuiImageList",slot:"Root",overridesResolver:(t,l)=>{const{ownerState:n}=t;return[l.root,l[n.variant]]}})(({ownerState:t})=>w({display:"grid",overflowY:"auto",listStyle:"none",padding:0,WebkitOverflowScrolling:"touch"},t.variant==="masonry"&&{display:"block"})),ge=u.forwardRef(function(l,n){const a=D({props:l,name:"MuiImageList"}),{children:s,className:g,cols:c=2,component:p="ul",rowHeight:r="auto",gap:d=4,style:m,variant:o="standard"}=a,f=B(a,he),x=u.useMemo(()=>({rowHeight:r,gap:d,variant:o}),[r,d,o]);u.useEffect(()=>{},[]);const j=o==="masonry"?w({columnCount:c,columnGap:d},m):w({gridTemplateColumns:`repeat(${c}, 1fr)`,gap:d},m),y=w({},a,{component:p,gap:d,rowHeight:r,variant:o}),i=pe(y);return e.jsx(fe,w({as:p,className:z(i.root,i[o],g),ref:n,style:j,ownerState:y},f,{children:e.jsx(W.Provider,{value:x,children:s})}))}),ve=ge;function be(t){return V("MuiImageListItem",t)}const je=A("MuiImageListItem",["root","img","standard","woven","masonry","quilted"]),I=je,ye=["children","className","cols","component","rows","style"],we=t=>{const{classes:l,variant:n}=t;return F({root:["root",n],img:["img"]},be,l)},Ne=L("li",{name:"MuiImageListItem",slot:"Root",overridesResolver:(t,l)=>{const{ownerState:n}=t;return[{[`& .${I.img}`]:l.img},l.root,l[n.variant]]}})(({ownerState:t})=>w({display:"block",position:"relative"},t.variant==="standard"&&{display:"flex",flexDirection:"column"},t.variant==="woven"&&{height:"100%",alignSelf:"center","&:nth-of-type(even)":{height:"70%"}},{[`& .${I.img}`]:w({objectFit:"cover",width:"100%",height:"100%",display:"block"},t.variant==="standard"&&{height:"auto",flexGrow:1})})),ke=u.forwardRef(function(l,n){const a=D({props:l,name:"MuiImageListItem"}),{children:s,className:g,cols:c=1,component:p="li",rows:r=1,style:d}=a,m=B(a,ye),{rowHeight:o="auto",gap:f,variant:x}=u.useContext(W);let j="auto";x==="woven"?j=void 0:o!=="auto"&&(j=o*r+f*(r-1));const y=w({},a,{cols:c,component:p,gap:f,rowHeight:o,rows:r,variant:x}),i=we(y);return e.jsx(Ne,w({as:p,className:z(i.root,i[x],g),ref:n,style:w({height:j,gridColumnEnd:x!=="masonry"?`span ${c}`:void 0,gridRowEnd:x!=="masonry"?`span ${r}`:void 0,marginBottom:x==="masonry"?f:void 0,breakInside:x==="masonry"?"avoid":void 0},d),ownerState:y},m,{children:u.Children.map(s,h=>u.isValidElement(h)?h.type==="img"||X(h,["Image"])?u.cloneElement(h,{className:z(i.img,h.props.className)}):h:null)}))}),_e=ke;var P={},Se=Z;Object.defineProperty(P,"__esModule",{value:!0});var U=P.default=void 0,Ce=Se(ne()),Me=e;U=P.default=(0,Ce.default)((0,Me.jsx)("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5zm4-3H19v1h1.5V11H19v2h-1.5V7h3zM9 9.5h1v-1H9zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm10 5.5h1v-3h-1z"}),"PictureAsPdf");function q({data:t=[]}){const l=a=>a==null?void 0:a.toLowerCase().endsWith(".pdf"),n=u.useMemo(()=>t.reduce((a,s)=>(a.some(c=>{var p,r;return((p=c==null?void 0:c.screenshotId)==null?void 0:p._id)===((r=s==null?void 0:s.screenshotId)==null?void 0:r._id)})||a.push(s),a),[]),[t]);return e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xs rounded-xl relative",children:[e.jsx("header",{className:"px-5 py-4",children:e.jsxs("h2",{className:"font-semibold text-slate-700 dark:text-slate-100",children:["All ScreeShots"," ",e.jsxs("span",{className:"text-slate-400 dark:text-slate-500 font-medium",children:["(",n==null?void 0:n.length,")"]})]})}),e.jsx("div",{children:e.jsx(se,{children:e.jsx(C,{sx:{width:"100%",height:450,overflowY:"scroll"},children:e.jsx(ve,{variant:"masonry",cols:3,gap:8,children:n==null?void 0:n.map(({screenshotId:a},s)=>e.jsx(_e,{children:l(a==null?void 0:a.screenshot_url)?e.jsx("div",{onClick:()=>window.open(a==null?void 0:a.screenshot_url,"_blank"),style:{cursor:"pointer",padding:"20px",textAlign:"center",border:"1px solid #ddd",borderRadius:"4px"},children:e.jsx(U,{sx:{fontSize:40,color:"#dc3545"}})}):e.jsx(ae,{src:`${a==null?void 0:a.screenshot_url}`,children:e.jsx(re.LazyLoadImage,{src:`${a==null?void 0:a.screenshot_url}`,effect:"blur",placeholderSrc:`${a==null?void 0:a.screenshot_url}`,style:{cursor:"pointer",width:"100%",height:"auto"},alt:"Screenshot"})},a==null?void 0:a._id)},a==null?void 0:a.screenshot_url))})})})})]})}q.propTypes={data:le.array};const Le=v.memo(q);function Te({latestScreenshots:t}){return e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xs rounded-xl relative",children:[e.jsx("header",{className:"px-5 py-4",children:e.jsxs("h2",{className:"font-semibold text-slate-700 dark:text-slate-100",children:["Latest Screenshots"," ",e.jsxs("span",{className:"text-slate-400 dark:text-slate-500 font-medium",children:["(",t.length,")"]})]})}),e.jsx("div",{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full dark:text-gray-300",children:[e.jsx("thead",{className:"text-xs font-semibold uppercase text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-900/20 border-t border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"Date"})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"Screenshot"})})]})}),e.jsx("tbody",{className:"text-sm divide-y divide-slate-200 dark:divide-slate-700",children:t.map((l,n)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-left font-medium text-emerald-500",children:oe(l.publish_date).format("MM/DD/YYYY")})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 ",children:e.jsx("div",{className:"text-left",children:e.jsx($,{to:l==null?void 0:l.screenshot_url,target:"_blank",children:l==null?void 0:l.original_url})})})]},n))})]})})})]})}const Ee=({coverageData:t,selectedYear:l,onYearSelect:n})=>{const[a,s]=v.useState(!1),g=v.useRef(null),c=v.useRef(null),p=v.useMemo(()=>{const r=new Set(t.map(m=>{var o;return b(m.date||((o=m.screenshotId)==null?void 0:o.createdAt)).year()})),d=b().year();return r.add(d),Array.from(r).sort((m,o)=>o-m)},[t]);return v.useEffect(()=>{const r=m=>{g.current&&!g.current.contains(m.target)&&c.current&&!c.current.contains(m.target)&&s(!1)},d=m=>{m.key==="Escape"&&s(!1)};return document.addEventListener("mousedown",r),document.addEventListener("keydown",d),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("keydown",d)}},[]),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{ref:c,onClick:()=>s(!a),className:"flex items-center justify-between w-full px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500","aria-haspopup":"listbox","aria-expanded":a,children:[l,e.jsx("svg",{className:"shrink-0 ml-1 fill-current text-slate-400",width:"11",height:"7",viewBox:"0 0 11 7",children:e.jsx("path",{d:"M5.4 6.8L0 1.4 1.4 0l4 4 4-4 1.4 1.4z"})})]}),e.jsx(ie,{show:a,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:e.jsx("div",{ref:g,className:"absolute z-10 w-full mt-1 bg-white rounded-md shadow-lg max-h-60 overflow-auto ring-1 ring-black ring-opacity-5 focus:outline-none",role:"listbox",children:p.map(r=>e.jsx("button",{className:`${r===l?"text-slate-300 bg-violet-600":"text-slate-900"} cursor-default select-none relative py-2 pl-3 pr-9 w-full text-left`,onClick:()=>{n(r),s(!1)},role:"option","aria-selected":r===l,children:r},r))})})]})},Re=({month:t,events:l})=>{const n=b(t).startOf("month"),s=b(t).endOf("month").date(),g=n.day(),[c,p]=v.useState(null),[r,d]=v.useState({top:0,left:0}),m=v.useRef(null),o=v.useRef(!1),f=(i,h)=>{clearTimeout(m.current),o.current=!0,p(i),d({top:h.bottom+window.scrollY,left:h.left+window.scrollX})},x=()=>{o.current=!1,m.current=setTimeout(()=>{o.current||p(null)},200)},j=Array.from({length:42},(i,h)=>{const N=h-g+1;if(N>0&&N<=s){const T=b(t).date(N),O=l.find(M=>b(M.date).isSame(T,"day"));return{day:N,event:O}}return null}),y=["S","M","T","W","T","F","S"];return e.jsxs("div",{className:"month-view relative",children:[e.jsx("h3",{className:"font-bold text-slate-500",children:b(t).format("MMM")}),e.jsx("div",{className:"days-grid days-header text-slate-500",children:y.map((i,h)=>e.jsx("div",{className:"day-label",children:i},h))}),e.jsx("div",{className:"days-grid",children:j.map((i,h)=>e.jsx("div",{className:"day-cell text-slate-500",children:i&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:i.day}),i.event&&e.jsx("div",{className:"event-circle",style:{width:`${Math.min(20+i.event.size*3,50)}px`,height:`${Math.min(20+i.event.size*3,50)}px`,backgroundColor:i.event.color,borderRadius:"50%"},onMouseEnter:N=>f(i.event,N.target.getBoundingClientRect()),onMouseLeave:x})]})},h))}),c&&e.jsxs("div",{className:"event-tooltip absolute bg-white shadow-md p-2 z-50",style:{top:`${r.top}px`,left:`${r.left}px`,borderRadius:"10px"},onMouseEnter:()=>{o.current=!0,clearTimeout(m.current)},onMouseLeave:x,children:[e.jsxs("h4",{className:"font-bold text-sm text-slate-500",children:[c.times.length," Screenshots"]}),e.jsx("h4",{className:"font-bold text-sm text-slate-500",children:b(c.date).format("MMMM D, YYYY")}),e.jsx("ul",{children:c.times.map((i,h)=>e.jsx("li",{className:"font-bold text-violet-500",children:e.jsx("a",{href:i==null?void 0:i.screenshot_url,target:"_blank",rel:"noopener noreferrer",children:b(i.date).format("HH:mm:ss")})},h))})]})]})},ze=t=>t<5?"#C8E6C9":t<10?"#81C784":t<20?"#4CAF50":t<30?"#388E3C":"#1B5E20",$e=({coverageData:t})=>{const l=b().year(),[n,a]=v.useState(l),s=Array.from({length:12},(r,d)=>b([n,d])),[g,c]=v.useState([]),p=v.useCallback(()=>{const r={},d={};t.forEach(o=>{const f=o.date||o.screenshotId&&o.screenshotId.createdAt;if(f){const x=b(f).format("YYYY-MM-DD");r[x]=(r[x]||0)+1,d[x]||(d[x]=[]),d[x].push({date:f,screenshot_url:o.screenshotId.screenshot_url})}});const m=Object.entries(r).map(([o,f])=>({date:o,size:f,color:ze(f),times:d[o]}));c(m)},[t]);return v.useEffect(()=>{p()},[p,n]),e.jsxs("div",{className:"coverage-over-time",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx("div",{className:"w-40",children:e.jsx(Ee,{coverageData:t,selectedYear:n,onYearSelect:a})})}),e.jsx("div",{className:"year-grid",children:s.map((r,d)=>e.jsx(Re,{month:r,events:g},d))})]})},Pe=$e;function Oe({dataList:t}){return u.useEffect(()=>{},[t]),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xs rounded-xl relative",children:[e.jsx("header",{className:"px-5 py-4",children:e.jsxs("h2",{className:"font-semibold text-slate-700 dark:text-slate-100",children:["Collections"," ",e.jsxs("span",{className:"text-slate-400 dark:text-slate-500 font-medium",children:["(",t.length,")"]})]})}),e.jsx("div",{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full dark:text-gray-300",children:[e.jsx("thead",{className:"text-xs font-semibold uppercase text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-900/20 border-t border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"Name"})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"Sources"})})]})}),e.jsx("tbody",{className:"text-sm divide-y divide-slate-200 dark:divide-slate-700",children:t.map(l=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 ",children:e.jsx("div",{className:"text-left",children:e.jsx($,{to:l.name,target:"_blank",children:l.name})})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-left font-medium text-emerald-500",children:l.szSources})})]}))})]})})})]})}const Ye=L(t=>e.jsx(ce,{...t,TabIndicatorProps:{children:e.jsx("span",{className:"MuiTabs-indicatorSpan"})}}))({"& .MuiTabs-indicator":{display:"flex",justifyContent:"center",backgroundColor:"transparent"},"& .MuiTabs-indicatorSpan":{width:"100%",backgroundColor:"#6366f1"}}),E=L(t=>e.jsx(me,{disableRipple:!0,...t}))(({theme:t})=>({fontWeight:t.typography.fontWeightRegular,fontSize:t.typography.pxToRem(15),marginRight:t.spacing(1),color:"#64748b",textTransform:"uppercase","&.Mui-selected":{color:"#6366f1"}}));function R(t){const{children:l,value:n,index:a,...s}=t;return e.jsx("div",{role:"tabpanel",hidden:n!==a,id:`simple-tabpanel-${a}`,"aria-labelledby":`simple-tab-${a}`,...s,children:n===a&&e.jsx(C,{sx:{p:3},children:e.jsx(e.Fragment,{children:l})})})}function lt(){const{id:t}=J(),[l,n]=u.useState(0),a=(k,_)=>{n(_)};u.useState("_");const[s,g]=u.useState(),[c,p]=u.useState([]),[r,d]=u.useState([]),[m,o]=u.useState([]),[f,x]=u.useState(!1),j=Q(),y=j==null?void 0:j.userPermissions,i="module_webshotBuzz",h="submodule_webshotBuzz_sourcesView",N=u.useMemo(()=>ee(y,i,h),[y]),[T,O]=u.useState(!1);u.useEffect(()=>{requestAnimationFrame(()=>{document.querySelectorAll("[data-name]").forEach(Y=>{const G=Y.getAttribute("data-name"),H=N.find(K=>K.id===G);H&&(H.enable||Y.remove())})})},[N,T]),u.useEffect(()=>{M()},[]);const M=async()=>{x(!0);try{const k={id:t},_=await te.post(`${de.sources}/getDetails`,k);_.status==200&&(g(_.data.source),p(_.data.source.screenshots),d(_.data.source.latest_screenshots),o(_.data.source.collectionData)),x(!1)}catch{x(!1)}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-9xl mx-auto",children:[e.jsxs("div",{className:"sm:flex sm:justify-between sm:items-center mb-8",children:[e.jsx("div",{className:"mb-4 sm:mb-0",children:e.jsxs("h1",{className:"text-2xl md:text-3xl text-slate-700 dark:text-slate-100 font-bold",children:[s==null?void 0:s.label," ✨"]})}),e.jsx("div",{className:"grid grid-flow-col sm:auto-cols-max justify-start sm:justify-end gap-2"})]}),e.jsxs(S,{"data-name":"feature_webshotBuzz_sourcesView_sourceInfo",container:!0,spacing:2,children:[e.jsx(S,{item:!0,md:3,children:e.jsx("div",{className:"col-span-full xl:col-span-6 2xl:col-span-4 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:"flex flex-col h-full p-5",children:e.jsxs("div",{className:"grow",children:[e.jsx("header",{className:"flex items-center mb-4",children:e.jsx("h3",{className:"text-md text-slate-700 dark:text-slate-100 font-semibold",children:"Total Screenshots"})}),e.jsx("div",{className:"text-sm",children:s==null?void 0:s.total_screenshots})]})})})}),e.jsx(S,{item:!0,md:3,children:e.jsx("div",{className:"col-span-full xl:col-span-6 2xl:col-span-4 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:"flex flex-col h-full p-5",children:e.jsxs("div",{className:"grow",children:[e.jsx("header",{className:"flex items-center mb-4",children:e.jsx("h3",{className:"text-md text-slate-700 dark:text-slate-100 font-semibold",children:"PUBLICATION COUNTRY"})}),e.jsx("div",{className:"text-sm",children:s!=null&&s.pub_country?s==null?void 0:s.pub_country:"_"})]})})})}),e.jsx(S,{item:!0,md:3,children:e.jsx("div",{className:"col-span-full xl:col-span-6 2xl:col-span-4 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:"flex flex-col h-full p-5",children:e.jsxs("div",{className:"grow",children:[e.jsx("header",{className:"flex items-center mb-4",children:e.jsx("h3",{className:"text-md text-slate-700 dark:text-slate-100 font-semibold",children:"PUBLICATION STATE"})}),e.jsx("div",{className:"text-sm",children:s!=null&&s.pub_state?s.pub_state:"_"})]})})})})]}),e.jsxs(C,{className:"mt-3",children:[e.jsx("label",{className:"mr-3 text-md font-bold text-slate-700",children:"Home Page"}),e.jsx($,{to:s!=null&&s.domain_name?"//"+(s==null?void 0:s.domain_name):"#",target:"_blank",children:s!=null&&s.domain_name?s==null?void 0:s.domain_name:"#"})]}),e.jsxs(C,{className:"mt-3",children:[e.jsx("label",{className:"mr-3 text-md font-bold text-slate-700",children:"Website type"}),s==null?void 0:s.website_type.map(k=>e.jsx("span",{className:"bg-violet-100 text-violet-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-full dark:bg-violet-900 dark:text-violet-300",children:k}))]}),e.jsxs(C,{className:"mt-3",children:[e.jsx("label",{className:"mr-3 text-md font-bold text-slate-700",children:"Category"}),s==null?void 0:s.category.map(k=>e.jsx("span",{className:"bg-violet-100 text-violet-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-full dark:bg-violet-900 dark:text-violet-300",children:k}))]}),e.jsxs(C,{className:"mt-5",children:[e.jsx(C,{children:e.jsxs(Ye,{value:l,onChange:a,"aria-label":"styled tabs example",children:[e.jsx(E,{"data-name":"feature_webshotBuzz_sourcesView_connectionList",label:"Connection List"}),e.jsx(E,{"data-name":"feature_webshotBuzz_sourcesView_coverageOverTime",label:"Coverage Over Time"}),e.jsx(E,{"data-name":"feature_webshotBuzz_sourcesView_listSS",label:"List Screenshots"})]})}),e.jsx(R,{value:l,index:0,children:e.jsxs(S,{container:!0,spacing:6,children:[e.jsx(S,{item:!0,sm:6,children:e.jsx(Oe,{dataList:m})}),e.jsx(S,{item:!0,sm:6,children:e.jsx(Te,{latestScreenshots:r})})]})}),e.jsx(R,{value:l,index:1,children:e.jsx(Pe,{coverageData:c})}),e.jsx(R,{value:l,index:2,children:e.jsx(Le,{data:c,reloadData:M})})]})]})})}export{lt as default};
