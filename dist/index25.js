import{j as e,r as l,V as je,aC as ve,az as re,T as oe,ao as ue,C as we,u as Ne,K as ke}from"./index.js";import{W as O}from"./connection2.js";import{a as Q}from"./apiBaseEndPoints.js";import{t as K}from"./toastr.js";import{D as Se}from"./DropdownEditMenu.js";import{D as _e}from"./DeleteModal.js";import{u as Ce,a as De,C as V}from"./index.esm.js";import{S as H,c as G}from"./reactSelectStyles.js";import{o as Me,c as Ae,a as Z,b as ce}from"./index.esm2.js";import{d as ze}from"./Add.js";import{d as Ee,h as Fe}from"./Remove.js";import{h as Re}from"./debounce.js";import{D as $e,a as Te,b as Le,c as qe}from"./DialogTitle.js";import{G as de}from"./Grid.js";import{I as me}from"./IconButton.js";import{r as he}from"./createSvgIcon2.js";import{R as Ve}from"./index35.js";import"./Menu.js";import"./Modal.js";import"./resolveComponentProps.js";import"./Backdrop.js";import"./useTheme.js";import"./useSlotProps.js";import"./Paper.js";import"./Grow.js";import"./floating-ui.dom.js";import"./createSvgIcon.js";import"./index34.js";function Ie({selectedItems:j,handleDeleteSources:g}){return e.jsx("div",{"data-name":"feature_webshotBuzz_sources_deleteSource",className:`${j.length<1&&"hidden"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"hidden xl:block text-sm italic mr-2 whitespace-nowrap",children:[e.jsx("span",{children:j.length})," items selected"]}),e.jsx("button",{className:"btn bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600 text-rose-500",onClick:()=>{g()},children:"Delete"})]})})}const pe=async j=>{var g;try{return(await O.delete(Q.sources+"/delete",{data:{sids:j}})).data}catch(a){(g=a==null?void 0:a.response)!=null&&g.data&&K.error(a.response.data.message)}};function Be({setCheckRendered:j,setOpenEdit:g,setEditableSource:a,data:D,reloadData:v}){const[w,y]=l.useState(!1),N=async()=>{const f=await pe([D._id]);f&&f.message&&(K.success(f.message),setTimeout(()=>{v()},100)),y(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(Se,{align:"right",children:[e.jsx("li",{children:e.jsx("button",{"data-name":"feature_webshotBuzz_sources_editSource",className:"font-medium text-sm text-slate-600 dark:text-slate-300 hover:text-slate-700 dark:hover:text-slate-200 flex py-1 px-3",onClick:f=>{g(!0),a(D)},children:"Edit"})}),e.jsx("li",{children:e.jsx("button",{"data-name":"feature_webshotBuzz_sources_viewSource",className:"font-medium text-sm text-slate-600 dark:text-slate-300 hover:text-slate-700 dark:hover:text-slate-200 flex py-1 px-3",children:e.jsx(je,{to:`source/${D._id}`,children:"View"})})}),e.jsx("li",{children:e.jsx("button",{"data-name":"feature_webshotBuzz_sources_deleteSource",className:"font-medium text-sm text-rose-500 hover:text-rose-600 flex py-1 px-3",onClick:()=>y(!0),children:"Delete"})})]}),e.jsx(_e,{isOpen:w,onClose:()=>y(!1),onConfirm:N,title:"Delete Source",description:`Are you sure you want to delete ${D.name}`,confirmText:"Delete",cancelText:"Cancel"})]})}const Pe=Ae().shape({label:Z().required("Label is required"),domain:Z().matches(/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!$&'()*+,;=]+$/,"Invalid URL").required("Domain is required"),screenshot_urls:ce().of(Z().url("Invalid URL").required("Screenshot URL is required")).min(1,"At least one screenshot URL is required").required("Screenshot URLs are required"),category:ce().min(1,"At least one category is required").required("Category is required"),country:Z().required("Country is required")});function xe({open:j,setOpen:g,data:a,reloadData:D,mode:v="add"}){const{languages:w,states:y,mediaType:N,countries:f,categories:k}=l.useContext(ve),[A,E]=l.useState(!1),[S,b]=l.useState([]),[M,_]=l.useState([]),o=l.useMemo(()=>(w==null?void 0:w.map(s=>({id:s,value:s,label:s})))||[],[w]),m=l.useMemo(()=>(f==null?void 0:f.map(s=>({id:s,value:s,label:s})))||[],[f]),R=l.useMemo(()=>(y==null?void 0:y.map(s=>({id:s,value:s,label:s})))||[],[y]),$=l.useMemo(()=>(N==null?void 0:N.map(s=>({value:s,label:s})))||[],[N]),B=l.useMemo(()=>(k==null?void 0:k.map(s=>({value:s.category,label:s.category})))||[],[k]),{register:z,reset:T,control:u,handleSubmit:P,setValue:r,getValues:x,watch:I,formState:{errors:d}}=Ce({defaultValues:{label:"",domain:"",screenshot_urls:[""],primary_language:"",category:[],subcategory:[],country:"",state:[],website_type:[]},mode:"onChange",resolver:Me(Pe)}),{fields:L,append:X,remove:ee}=De({control:u,name:"screenshot_urls"}),se=l.useCallback(Re(async(s,i)=>{if(!i){_(t=>t.map(n=>n.fieldName===s?{...n,status:!1}:n));return}try{const t={screenshotUrl:i},n=await O.post(`${Q.sources}/check-url`,t);_(c=>[...c.filter(p=>p.fieldName!==s),{fieldName:s,status:n.status===200}])}catch(t){_(n=>[...n.filter(c=>c.fieldName!==s),{fieldName:s,status:!1}]),console.error("Error while checking URL:",t.message)}},500),[]),J=l.useCallback(s=>{const i=(s==null?void 0:s.map(p=>p==null?void 0:p.value))||[],t=new Set;i.forEach(p=>{const C=k==null?void 0:k.find(q=>q.category===p);C&&C.subCategories.forEach(q=>t.add(q))});const n=[...t].map(p=>({value:p,label:p}));b(n);const c=x("subcategory");(c==null?void 0:c.length)>0&&r("subcategory",c.filter(p=>n.some(C=>C.value===p)))},[k,x,r]);l.useEffect(()=>{var s,i,t;if(j)if(v==="edit"&&a){const n=((s=a==null?void 0:a.screenshot_urls)==null?void 0:s.map((p,C)=>({fieldName:`screenshot_urls.${C}`,status:!0})))||[];_(n);const c={label:(a==null?void 0:a.label)||"",domain:(a==null?void 0:a.domain_name)||"",screenshot_urls:(i=a==null?void 0:a.screenshot_urls)!=null&&i.length?a.screenshot_urls:[""],primary_language:a.primary_language||"",category:(a==null?void 0:a.category)||[],subcategory:(a==null?void 0:a.sub_categories)||[],country:(a==null?void 0:a.pub_country)||"",state:(a==null?void 0:a.pub_state)||[],website_type:(a==null?void 0:a.website_type)||[]};if(T(c),(t=a==null?void 0:a.category)!=null&&t.length){const p=a.category.map(C=>({value:C,label:C}));J(p)}}else T({label:"",domain:"",screenshot_urls:[""],primary_language:"",category:[],subcategory:[],country:"",state:[],website_type:[]}),_([]),b([])},[j,a,v,T,J]);const U=async s=>{var t,n;if(!(M.length===s.screenshot_urls.length&&M.every(c=>c.status===!0))){K.error("Please ensure all screenshot URLs are valid");return}E(!0);try{const c=new FormData;Object.entries(s).forEach(([q,W])=>{Array.isArray(W)?W.forEach(F=>c.append(`${q}[]`,F)):c.append(q,W||"")}),v==="edit"&&c.append("source_id",a._id);const p=v==="add"?`${Q.sources}/create`:`${Q.sources}/update`,C=await O.post(p,c,{headers:{"Content-Type":"multipart/form-data"}});K.success(C.data.message),h(),D()}catch(c){K.error(((n=(t=c.response)==null?void 0:t.data)==null?void 0:n.message)||"Internal Error")}finally{E(!1)}},te=s=>{var t,n,c;return!((t=d.screenshot_urls)==null?void 0:t[s])&&((c=(n=L[s])==null?void 0:n.value)==null?void 0:c.trim())!==""},h=()=>{g(!1),T(),_([])};return e.jsx($e,{fullWidth:!0,open:j,onClose:h,maxWidth:"md",sx:{"& .MuiDialog-paper":{borderRadius:"10px"}},children:e.jsxs("form",{onSubmit:P(U),className:"bg-white dark:bg-gray-800 overflow-auto dark:text-slate-300",children:[e.jsx(Te,{className:"sticky top-0 px-5 py-4 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700/60 z-10",children:e.jsxs("h3",{className:"text-xl md:text-xl text-slate-700 dark:text-slate-100 font-bold",children:[v==="add"?"Add":"Edit"," Source"]})}),e.jsx(Le,{children:e.jsx(de,{container:!0,spacing:2,children:e.jsxs(de,{item:!0,md:9,mb:8,children:[e.jsx(V,{name:"label",control:u,render:({field:s})=>e.jsxs("div",{className:"w-full mb-3",children:[e.jsx("label",{children:"Label"}),e.jsx("input",{className:"form-input w-full mt-1",...s}),d.label&&e.jsx("span",{className:"text-rose-500",children:d.label.message})]})}),e.jsx(V,{name:"domain",control:u,render:({field:s})=>e.jsxs("div",{className:"w-full mb-3",children:[e.jsx("label",{children:"Domain"}),e.jsx("input",{className:"form-input w-full mt-1",...s}),d.domain&&e.jsx("span",{className:"text-rose-500",children:d.domain.message})]})}),e.jsx("label",{children:"Screenshot URLs"}),L.map((s,i)=>{var c,p,C,q,W;const t=i<L.length-1&&te(i)&&!((c=d.screenshot_urls)!=null&&c[i]),n=!t;return e.jsxs(re.Fragment,{children:[e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("div",{className:"flex-grow",children:e.jsx(V,{name:`screenshot_urls.${i}`,control:u,render:({field:{name:F,value:ne,onChange:ae}})=>e.jsx("input",{name:F,value:ne,onChange:Y=>{ae(Y.target.value),/^(https?:\/\/[^\s]+)/.test(Y.target.value)?se(F,Y.target.value):Y.target.value===""&&_(be=>be.filter(ye=>ye.fieldName!==F))},className:"form-input w-full p-2 border border-gray-300 rounded-md"})})}),M.some(F=>F.fieldName===`screenshot_urls.${i}`)&&e.jsx(oe,{variant:"body2",className:"mx-3",children:(p=M.find(F=>F.fieldName===`screenshot_urls.${i}`))!=null&&p.status?e.jsx("span",{className:"text-green-500",children:"200"}):e.jsx("span",{className:"text-red-500",children:"Error"})}),t&&e.jsx(oe,{variant:"body2",color:"textSecondary",className:"mx-3",children:"OR"}),n&&e.jsxs(e.Fragment,{children:[e.jsx(me,{onClick:()=>{_(F=>F.filter((ne,ae)=>ae!==i)),ee(i)},disabled:L.length===1,children:e.jsx(Ee,{})}),e.jsx(me,{disabled:((C=M[i])==null?void 0:C.fieldName)===`screenshot_urls.${i}`&&!((q=M[i])!=null&&q.status),onClick:()=>X(""),children:e.jsx(ze,{})})]})]}),((W=d.screenshot_urls)==null?void 0:W[i])&&e.jsx("span",{className:"text-rose-500 text-sm mt-1 block",children:d.screenshot_urls[i].message})]},s.id)}),e.jsx(V,{name:"category",control:u,render:({field:{value:s,onChange:i}})=>e.jsxs("div",{className:"w-full mb-3",children:[e.jsx("label",{children:"Category"}),e.jsx(H,{className:"mt-1",options:B,value:B.filter(t=>s==null?void 0:s.includes(t.value)),onChange:t=>{i((t==null?void 0:t.map(n=>n.value))||[]),J(t)},isSearchable:!0,isMulti:!0,placeholder:"Select categories",styles:G()}),d.category&&e.jsx("span",{className:"text-rose-500",children:d.category.message})]})}),e.jsx(V,{name:"subcategory",control:u,render:({field:{value:s,onChange:i}})=>e.jsxs("div",{className:"w-full mb-3",children:[e.jsx("label",{children:"Sub Category"}),e.jsx(H,{className:"mt-1",options:S,value:S.filter(t=>s==null?void 0:s.includes(t.value)),onChange:t=>i((t==null?void 0:t.map(n=>n.value))||[]),isSearchable:!0,isMulti:!0,placeholder:"Select sub categories",styles:G()}),d.subcategory&&e.jsx("span",{className:"text-rose-500",children:d.subcategory.message})]})}),e.jsx(V,{name:"country",control:u,render:({field:{value:s,onChange:i}})=>e.jsxs("div",{className:"w-full mb-3",children:[e.jsx("label",{children:"Publish Country"}),e.jsx(H,{className:"mt-1",options:m,value:m.find(t=>t.value===s),onChange:t=>{i((t==null?void 0:t.value)||null),t?Fe(t.id).then(n=>{setStatesOptions((n==null?void 0:n.map(c=>({value:c.name,label:c.name})))||[])}):setStatesOptions([])},isSearchable:!0,isClearable:!0,placeholder:"Select Country",styles:G()}),d.country&&e.jsx("span",{className:"text-rose-500",children:d.country.message})]})}),e.jsx(V,{name:"state",control:u,render:({field:{value:s,onChange:i}})=>e.jsxs("div",{className:"w-full mb-3",children:[e.jsx("label",{children:"Publish State"}),e.jsx(H,{className:"mt-1",options:R,value:R.filter(t=>s==null?void 0:s.includes(t.value)),onChange:t=>i((t==null?void 0:t.map(n=>n.value))||[]),isSearchable:!0,isMulti:!0,placeholder:"Select States",styles:G()}),d.state&&e.jsx("span",{className:"text-rose-500",children:d.state.message})]})}),e.jsx(V,{name:"primary_language",control:u,render:({field:{value:s,onChange:i}})=>e.jsxs("div",{className:"w-full mb-3",children:[e.jsx("label",{children:"Primary Language"}),e.jsx(H,{className:"mt-1",options:o,value:o.find(t=>t.value===s),onChange:t=>i((t==null?void 0:t.value)||null),isSearchable:!0,isClearable:!0,placeholder:"Select Languages",styles:G()}),d.primary_language&&e.jsx("span",{className:"text-rose-500",children:d.primary_language.message})]})}),e.jsx(V,{name:"website_type",control:u,render:({field:{value:s,onChange:i}})=>e.jsxs("div",{className:"w-full mb-3",children:[e.jsx("label",{children:"Website Type"}),e.jsx(H,{className:"mt-1 z-10",options:$,value:$.filter(t=>s==null?void 0:s.includes(t.value)),onChange:t=>i((t==null?void 0:t.map(n=>n.value))||[]),isSearchable:!0,isMulti:!0,placeholder:"Select Website Types",styles:G()}),d.website_type&&e.jsx("span",{className:"text-rose-500",children:d.website_type.message})]})})]})})}),e.jsxs(qe,{className:"sticky bottom-0 px-5 py-4 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700/60",children:[e.jsx("button",{type:"button",className:"btn bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700/60 hover:border-gray-300 dark:hover:border-gray-600 text-gray-800 dark:text-gray-300",onClick:h,children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn bg-gray-900 text-gray-100 hover:bg-gray-800 dark:bg-gray-100 dark:text-gray-800 dark:hover:bg-white disabled:border-gray-200 dark:disabled:border-gray-700 disabled:bg-white dark:disabled:bg-gray-800 disabled:text-gray-300 dark:disabled:text-gray-600 disabled:cursor-not-allowed",disabled:A,children:[A&&e.jsx("svg",{className:"animate-spin fill-current shrink-0",width:"16",height:"16",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M8 16a7.928 7.928 0 01-3.428-.77l.857-1.807A6.006 6.006 0 0014 8c0-3.309-2.691-6-6-6a6.006 6.006 0 00-5.422 8.572l-1.806.859A7.929 7.929 0 010 8c0-4.411 3.589-8 8-8s8 3.589 8 8-3.589 8-8 8z"})}),"Save"]})]})]})})}var le={},Ue=ue;Object.defineProperty(le,"__esModule",{value:!0});var ge=le.default=void 0,We=Ue(he()),He=e;ge=le.default=(0,We.default)((0,He.jsx)("path",{d:"M10 18h4v-2h-4zM3 6v2h18V6zm3 7h12v-2H6z"}),"FilterList");var ie={},Ge=ue;Object.defineProperty(ie,"__esModule",{value:!0});var fe=ie.default=void 0,Ke=Ge(he()),Je=e;fe=ie.default=(0,Ke.default)((0,Je.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");const Qe=({columns:j,data:g,setTableFilters:a})=>{const[D,v]=l.useState(!1),[w,y]=l.useState({}),N=l.useRef([]);l.useEffect(()=>{N.current.length===0&&g.length>0&&(N.current=[...g])},[g]);const f=N.current,k=()=>v(!D),A=()=>v(!1),E=(o,m)=>{y(R=>({...R,[o]:m}))},S=()=>y({}),b=o=>{const m={...w};delete m[o],y(m)},M=o=>{const m=f.flatMap(R=>{const $=R[o];return Array.isArray($)?$:[$]});return[...new Set(m)].filter(Boolean)},_=o=>o.charAt(0).toUpperCase()+o.slice(1);return l.useEffect(()=>{a(w)},[w]),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:Object.entries(w).filter(([o,m])=>m).map(([o,m])=>e.jsxs("div",{className:"flex items-center bg-gray-100 dark:bg-gray-700 rounded-full px-3 py-1 text-sm",children:[e.jsxs("span",{className:"mr-1",children:[_(o),": ",m]}),e.jsx("button",{onClick:()=>b(o),className:"text-gray-500 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-100",children:e.jsx(fe,{fontSize:"small"})})]},o))}),e.jsx(ge,{className:"text-slate-400 dark:text-slate-500 cursor-pointer",onClick:k}),D&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-end p-4",onClick:A,children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl p-4 min-w-[300px]",onClick:o=>o.stopPropagation(),children:[e.jsx("div",{className:"flex justify-between mb-4 float",children:e.jsx("button",{onClick:S,className:"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:"Reset"})}),j.map(o=>e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:_(o)}),e.jsxs("select",{value:w[o]||"",onChange:m=>E(o,m.target.value),className:"form-select w-full",children:[e.jsx("option",{value:"",children:"None"}),M(o).map(m=>e.jsx("option",{value:m,children:m},m))]})]},o))]})})]})};function Xe({setCheckRendered:j,selectedItems:g,data:a,total:D,reloadData:v,sortFilter:w,setConfig:y,setFilters:N,loading:f}){const[k,A]=l.useState(!1),[E,S]=l.useState([]),[b,M]=l.useState(w),[_,o]=re.useState(!1),[m,R]=re.useState(null);l.useEffect(()=>{A(!1),S([])},[a]);const $=()=>{A(!k),S(a.map(r=>`${r._id}`)),k&&S([])},B=r=>{const{id:x,checked:I}=r.target;A(!1),S([...E,x]),I||S(E.filter(d=>d!==x))};l.useEffect(()=>{g(E)},[E]);const z=r=>{let x="ascending";b.key===r&&(x=b.direction==="ascending"?"descending":"ascending"),M({key:r,direction:x}),y({key:r,direction:x})},T=l.useMemo(()=>b.key?[...a].sort((r,x)=>r[b.key]<x[b.key]?b.direction==="ascending"?-1:1:r[b.key]>x[b.key]?b.direction==="ascending"?1:-1:0):a,[a,b]),u=r=>b.key===r?b.direction==="ascending"?"↑":"↓":"↕",P=["category","pub_country","pub_state","primary_language","website_type"];return e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xs rounded-xl relative",children:[e.jsxs("header",{className:"px-5 py-4 flex justify-between items-center",children:[e.jsxs("h2",{className:"font-semibold text-slate-700 dark:text-slate-100",children:["All Sources"," ",e.jsx("span",{className:"text-slate-400 dark:text-slate-500 font-medium",children:D})]}),e.jsx(Qe,{columns:P,data:T,setTableFilters:N})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full dark:text-gray-300",children:[e.jsx("thead",{className:"text-xs font-semibold uppercase text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-900/20 border-t border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap w-px",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"inline-flex",children:[e.jsx("span",{className:"sr-only",children:"Select all"}),e.jsx("input",{className:"w-4 h-4 text-violet-600 bg-gray-100 border-gray-300 rounded focus:ring-violet-500 dark:focus:ring-violet-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-slate-300",type:"checkbox",checked:k,onChange:$})]})})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap cursor-pointer",onClick:()=>{z("label")},children:e.jsxs("div",{className:"font-semibold text-left",children:["Label ",u("label")]})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap cursor-pointer",onClick:()=>{z("domain_name")},children:e.jsxs("div",{className:"font-semibold text-left",children:["Domain ",u("domain_name")]})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap cursor-pointer",onClick:()=>{z("category")},children:e.jsxs("div",{className:"font-semibold text-left",children:["Category ",u("category")]})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap cursor-pointer",onClick:()=>{z("pub_country")},children:e.jsxs("div",{className:"font-semibold text-left",children:["Country ",u("pub_country")]})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap cursor-pointer",onClick:()=>{z("pub_state")},children:e.jsxs("div",{className:"font-semibold text-left",children:["State ",u("pub_state")]})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap cursor-pointer",onClick:()=>{z("primary_language")},children:e.jsxs("div",{className:"font-semibold text-left",children:["Language ",u("primary_language")]})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap cursor-pointer",onClick:()=>{z("website_type")},children:e.jsxs("div",{className:"font-semibold text-left",children:["Type ",u("website_type")]})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap cursor-pointer",onClick:()=>{z("total_urls")},children:e.jsxs("div",{className:"font-semibold text-left",children:["Total Urls ",u("total_urls")]})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap cursor-pointer",onClick:()=>{z("total_screenshots")},children:e.jsxs("div",{className:"font-semibold text-left",children:["Total Screenshots ",u("total_screenshots")]})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("span",{className:"sr-only",children:"Menu"})})]})}),e.jsx("tbody",{className:"text-sm divide-y divide-slate-200 dark:divide-slate-700",children:f?e.jsx("tr",{children:e.jsx("td",{colSpan:"100%",style:{textAlign:"center",padding:"22px"},children:e.jsx(we,{})})}):T.map(r=>{var x,I,d,L;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap w-px",children:e.jsx("div",{className:"flex items-center",children:e.jsx("label",{className:"inline-flex",children:e.jsx("input",{id:r._id,className:"w-4 h-4 text-violet-600 bg-gray-100 border-gray-300 rounded focus:ring-violet-500 dark:focus:ring-violet-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-slate-300",type:"checkbox",onChange:B,checked:E.includes(`${r._id}`)})})})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-left",children:`${(x=r==null?void 0:r.label)==null?void 0:x.slice(0,10)}...`})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-left",children:r.domain_name})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-left",children:Array.isArray(r==null?void 0:r.category)?(I=r==null?void 0:r.category)==null?void 0:I.join(", "):""})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-center",children:r.pub_country})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-center",children:Array.isArray(r==null?void 0:r.pub_state)?(d=r==null?void 0:r.pub_state)==null?void 0:d.join(", "):""})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-center",children:r.primary_language})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-center",children:Array.isArray(r==null?void 0:r.website_type)?(L=r==null?void 0:r.website_type)==null?void 0:L.join(", "):""})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-center",children:r.total_urls})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-center",children:r==null?void 0:r.total_screenshots})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap w-px",children:e.jsx(Be,{setCheckRendered:j,setOpenEdit:o,setEditableSource:R,data:r,reloadData:v})})]},r._id)})})]})}),e.jsx(xe,{open:_,setOpen:o,data:m,reloadData:v,mode:"edit"})]})}function _s(){const[j,g]=l.useState([]),[a,D]=l.useState({key:"label",direction:"ascending"}),[v,w]=l.useState([]),[y,N]=l.useState(!1),[f,k]=l.useState(""),[A,E]=l.useState(),[S,b]=l.useState(),[M,_]=l.useState(10),[o,m]=l.useState(1),[R,$]=l.useState(0),[B,z]=l.useState(0),[T,u]=l.useState(!1),[P,r]=l.useState({}),x=Ne(),I=x==null?void 0:x.userPermissions,d="module_webshotBuzz",L="submodule_webshotBuzz_sources",X=l.useMemo(()=>ke(I,d,L),[I]),[ee,se]=l.useState(!1);l.useEffect(()=>{requestAnimationFrame(()=>{document.querySelectorAll("[data-name]").forEach(i=>{const t=i.getAttribute("data-name"),n=X.find(c=>c.id===t);n&&(n.enable||i.remove())})})},[X,ee]);const J=h=>{g([...h])};l.useEffect(()=>{const h=setTimeout(()=>{y||U()},1e3);return()=>clearTimeout(h)},[f,P,a,o,S,A]),l.useEffect(()=>{m(1)},[f]);const U=async()=>{N(!0);try{const h={pageSize:M,page:o,searchValue:f,from:S?new Date(S):void 0,to:A?new Date(A):void 0,sortKey:a.key,sortDirection:a.direction,filters:P},s=await O.post(`${Q.sources}/getAdvancedSources`,h);if(s.status===200){const i=s.data.total;z(Math.ceil(i/M)),$(s.data.total),w(s.data.source),g([])}N(!1)}catch(h){console.error(h),N(!1)}},te=async()=>{const h=await pe(j);h&&h.message&&(g([]),K.success(h.message),setTimeout(()=>{U()},100))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-6 p-space-y-6",children:[e.jsxs("div",{className:"sm:flex sm:justify-between sm:items-center mb-8",children:[e.jsx("div",{className:"mb-4 sm:mb-0",children:e.jsx("h1",{className:"text-2xl md:text-3xl text-slate-700 dark:text-slate-100 font-bold",children:"Sources ✨"})}),e.jsxs("div",{className:"grid grid-flow-col sm:auto-cols-max justify-start sm:justify-end gap-1",children:[e.jsx(Ie,{selectedItems:j,handleDeleteSources:te}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{htmlFor:"action-search",className:"sr-only",children:"Search"}),e.jsx("input",{className:"form-input pl-9 bg-white dark:bg-slate-800",placeholder:"Search Sources",value:f,onChange:h=>{k(h.target.value)}}),e.jsx("button",{className:"absolute inset-0 right-auto group",type:"submit","aria-label":"Search",children:e.jsxs("svg",{className:"w-4 h-4 shrink-0 fill-current text-slate-400 dark:text-slate-500 group-hover:text-slate-500 dark:group-hover:text-slate-400 ml-3 mr-2",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M7 14c-3.86 0-7-3.14-7-7s3.14-7 7-7 7 3.14 7 7-3.14 7-7 7zM7 2C4.243 2 2 4.243 2 7s2.243 5 5 5 5-2.243 5-5-2.243-5-5-5z"}),e.jsx("path",{d:"M15.707 14.293L13.314 11.9a8.019 8.019 0 01-1.414 1.414l2.393 2.393a.997.997 0 001.414 0 .999.999 0 000-1.414z"})]})})]}),e.jsxs("button",{"data-name":"feature_webshotBuzz_sources_addSource",className:"btn bg-gray-900 text-gray-100 hover:bg-gray-800 dark:bg-gray-100 dark:text-gray-800 dark:hover:bg-white",onClick:h=>{u(!0)},children:[e.jsx("svg",{className:"w-4 h-4 fill-current opacity-50 shrink-0",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M15 7H9V1c0-.6-.4-1-1-1S7 .4 7 1v6H1c-.6 0-1 .4-1 1s.4 1 1 1h6v6c0 .6.4 1 1 1s1-.4 1-1V9h6c.6 0 1-.4 1-1s-.4-1-1-1z"})}),e.jsx("span",{className:"hidden xs:block ml-2",children:"Add Source"})]})]})]}),e.jsx(Xe,{setCheckRendered:se,selectedItems:J,data:v,total:R,reloadData:U,sortFilter:a,setConfig:h=>{D(h)},setFilters:r,loading:y}),e.jsx("div",{className:"mt-8",children:e.jsx(Ve,{current:o,total:B,onPageChange:m})})]}),e.jsx(xe,{open:T,setOpen:u,data:v,reloadData:U,mode:"add"})]})}export{_s as default};
