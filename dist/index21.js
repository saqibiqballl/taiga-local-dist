import{d as w,aH as _,r as p,j as n}from"./index.js";import{n as f}from"./notify.js";async function z(t,e){const a=await fetch(t,e);return a.status===401?(window.location.href="/login",null):a}const O={headers:{Accept:"application/json",Origin:"http://localhost:5173","Content-Type":"application/json","api-key":"SOCIALRADAR_kNfOdiOXgYycGCH8KA"}};async function E(){const t={...O,method:"GET"};return await(await fetch(`${w}/api/org`,t)).json()}async function S(t){const e={...O,method:"DELETE"};return(await z(`${w}/api/org/${t}`,e)).status===200}async function b(t){const e={...O,method:"POST",body:JSON.stringify(t)};return await(await z(`${w}/api/org`,e)).json()}async function $(t){const e={...O,method:"PUT",body:JSON.stringify(t)};return await(await z(`${w}/api/org`,e)).json()}function C(){const t=_();return e=>{t({type:"popup/set",payload:e}),document.getElementById("Popup").style.display="flex"}}function v(){const t=_();return()=>{document.getElementById("Popup").style.display="none",t({type:"popup/set",payload:null})}}const P="_NewOrganization_18rr4_1",R={NewOrganization:P},x=["org","admin"],k=t=>{const{onCreate:e}=t,[a,c]=p.useState(x[0]),[l,d]=p.useState(""),[o,i]=p.useState(""),r=v();function h(s){c(s.target.value)}function m(s){d(s.target.value)}function g(s){i(s.target.value)}async function j(){try{const s=await b({role:a,name:l,pwd:o});e(s),r(),c(x[0]),d(""),i("")}catch{f("An error occurred.")}}function u(){r()}return n.jsxs("div",{className:`Modal ${R.NewOrganization}`,children:[n.jsx("h1",{children:"New Organization"}),n.jsx("select",{onChange:h,value:a,children:x.map(s=>n.jsx("option",{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))}),n.jsx("input",{className:"Name",type:"text",value:l,onChange:m,placeholder:"Name"}),n.jsx("input",{type:"password",value:o,onChange:g,placeholder:"New Password"}),n.jsxs("div",{children:[n.jsx("button",{onClick:j,children:"Submit"}),n.jsx("button",{onClick:u,children:"Close"})]})]})},A="_Organization_msc4z_1",M="_Edit_msc4z_27",H={Organization:A,Edit:M},D="_EditOrganization_3lz2v_1",L="_Name_3lz2v_33",y={EditOrganization:D,Name:L},T=t=>{const{_id:e,name:a,onEdit:c}=t,[l,d]=p.useState(a),[o,i]=p.useState(""),r=v();function h(u){d(u.target.value)}function m(u){i(u.target.value)}async function g(){try{const u=await $({_id:e,name:l,pwd:o});c(u),r(),d(""),i("")}catch{f("An error occurred.")}}function j(){r()}return n.jsxs("div",{className:`Modal ${y.EditOrganization}`,children:[n.jsx("h1",{children:"Edit Organization"}),n.jsx("input",{className:y.Name,type:"text",value:l,onChange:h,placeholder:"Name"}),n.jsx("input",{type:"password",value:o,onChange:m,placeholder:"New Password"}),n.jsx("p",{children:"Leave blank to keep the current password."}),n.jsxs("div",{children:[n.jsx("button",{onClick:g,children:"Submit"}),n.jsx("button",{onClick:j,children:"Close"})]})]})},I=t=>{const{_id:e,name:a,role:c,onDelete:l}=t,[d,o]=p.useState(a),i=C();async function r(){if(!await S(e)){f("An error occurred.");return}l(e)}function h(g){o(g.name)}function m(){i(n.jsx(T,{_id:e,name:d,onEdit:h}))}return n.jsxs("div",{className:`Row ${H.Organization}`,children:[n.jsxs("div",{children:[n.jsx("span",{children:c}),d]}),n.jsxs("div",{children:[n.jsx("button",{className:"Edit",onClick:m,children:"Edit"}),n.jsx("button",{onClick:r,children:"Delete"})]})]})},B="_OrganizationModal_1uj34_1",U="_Header_1uj34_11",G="_Row_1uj34_25",N={OrganizationModal:B,Header:U,Row:G},J=()=>{const[t,e]=p.useState([]),a=C();p.useEffect(()=>{(async()=>{const o=await E();e(o)})()},[]);function c(o){const i=t.findIndex(r=>r._id===o);e([...t.slice(0,i),...t.slice(i+1)])}function l(o){e([...t,o])}function d(){a(n.jsx(k,{onCreate:l}))}return n.jsxs("div",{className:`Modal ${N.OrganizationModal}`,children:[n.jsx("h1",{children:"Organization Settings"}),n.jsxs("div",{className:`Row ${N.Header}`,children:[n.jsx("p",{children:n.jsxs("b",{children:[t.length," Organizations"]})}),n.jsx("button",{onClick:d,children:"New Organization"})]}),t.map(({_id:o,name:i,role:r})=>n.jsx(I,{_id:o,name:i,role:r,onDelete:c},o))]})},F="_OrganizationSettings_1ehww_1",K={OrganizationSettings:F},q=()=>n.jsx("div",{className:K.OrganizationSettings,children:n.jsx(J,{})});export{q as default};
