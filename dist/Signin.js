import{j as e,a as g,u as O,b as _,c as E,r as u,C as L,d as S}from"./index.js";import{u as I,C as b}from"./index.esm.js";import{t as P}from"./toastr.js";import{I as R}from"./IconButton.js";import{c as w}from"./createSvgIcon.js";const M=w(e.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),V=w(e.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff"),D="/auth-image.jpg",Z="/auth-decoration.png";class q{constructor(){}static async loginAndData(n,t){return new Promise(async(c,r)=>{try{const a=await(await g.post(n,t,{headers:{"Content-type":"application/json","api-key":"SOCIALRADAR_kNfOdiOXgYycGCH8KA"}})).data;if(a.error){const l=new Error(a.error);r(l)}else if(a){const l={isLoggedIn:a.isLoggedIn,...a==null?void 0:a.user,token:a==null?void 0:a.token};c(l)}else{const l=new Error("Logging in failed. please provide right data");r(l)}}catch(s){r(s)}})}static async signupAndData(n,t){return new Promise(async(c,r)=>{try{const{data:s}=await g.post(n,t,{headers:{"content-type":"application/json","api-key":"SOCIALRADAR_kNfOdiOXgYycGCH8KA"}});if(s)c({...s,token:s==null?void 0:s.token});else{const a=new Error("failed to register a user. Please provide correct data");r(a)}}catch(s){r(s)}})}static async contactAndData(n,t){return new Promise(async(c,r)=>{try{const{data:s}=await g.post(n,t,{headers:{"content-type":"application/json","api-key":"SOCIALRADAR_kNfOdiOXgYycGCH8KA"}});if(s)c({...s,token:s==null?void 0:s.token});else{const a=new Error("failed to contact a user. Please provide correct data or Try again if problem presist contact through the support team");r(a)}}catch(s){r(s)}})}}function z(){var p,f;const{control:d,handleSubmit:n,formState:{errors:t},setValue:c}=I({defaultValues:{usernameOrEmail:"",password:"",user_login_code:""}}),r=O(),s=_(),a=E(),[l,h]=u.useState(!1),y=((f=(p=a.state)==null?void 0:p.from)==null?void 0:f.pathname)||"/dashboard",[i,j]=u.useState(!1),[x,v]=u.useState(!1),k=()=>v(o=>!o),N=async o=>{h(!0);try{const m=i?{usernameOrEmail:o.usernameOrEmail,user_login_code:o.user_login_code}:{password:o.password,usernameOrEmail:o.usernameOrEmail},C=await q.loginAndData(`${S}/api/auth/4172-login`,m);r.loginUser(C,()=>s(y,{replace:!0}))}catch(m){P.error(m.message||"Please check if your username or password is correct.")}finally{h(!1)}},A=()=>{j(!i),c(i?"password":"user_login_code","")};return r?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative md:flex",children:[e.jsx("div",{className:"md:w-1/2",children:e.jsxs("div",{className:"min-h-[100dvh] h-full flex flex-col after:flex-1",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex items-center justify-between h-16 px-4 sm:px-6 lg:px-8",children:e.jsx("svg",{className:"fill-violet-500",xmlns:"http://www.w3.org/2000/svg",width:32,height:32,children:e.jsx("path",{d:"M31.956 14.8C31.372 6.92 25.08.628 17.2.044V5.76a9.04 9.04 0 0 0 9.04 9.04h5.716ZM14.8 26.24v5.716C6.92 31.372.63 25.08.044 17.2H5.76a9.04 9.04 0 0 1 9.04 9.04Zm11.44-9.04h5.716c-.584 7.88-6.876 14.172-14.756 14.756V26.24a9.04 9.04 0 0 1 9.04-9.04ZM.044 14.8C.63 6.92 6.92.628 14.8.044V5.76a9.04 9.04 0 0 1-9.04 9.04H.044Z"})})})}),e.jsxs("div",{className:"max-w-sm mx-auto w-full px-4 py-8",children:[e.jsx("h1",{className:"text-3xl text-slate-700 dark:text-slate-100 font-bold mb-6",children:"Welcome back! âœ¨"}),e.jsxs("form",{className:"px-2",onSubmit:n(N),children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(b,{name:"usernameOrEmail",control:d,rules:{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}},render:({field:o})=>e.jsxs("div",{className:"w-full mb-3",children:[e.jsx("label",{children:"Email"}),e.jsx("input",{className:`form-input w-full mt-1 ${t.usernameOrEmail?"border-rose-500":""}`,...o}),t.usernameOrEmail&&e.jsx("p",{className:"mt-1 text-sm text-rose-500",children:t.usernameOrEmail.message})]})}),e.jsx(b,{name:i?"user_login_code":"password",control:d,rules:{required:i?"Login code is required":"Password is required"},render:({field:o})=>e.jsxs("div",{className:"w-full mb-3",children:[e.jsx("label",{children:i?"Login Code":"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:`form-input w-full pr-8 ${t[i?"user_login_code":"password"]?"border-rose-500":""}`,...o,type:i||x?"text":"password"}),!i&&e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx(R,{"aria-label":"toggle password visibility",onClick:k,edge:"end",children:x?e.jsx(V,{}):e.jsx(M,{})})})]}),t[i?"user_login_code":"password"]&&e.jsx("p",{className:"mt-1 text-sm text-rose-500",children:t[i?"user_login_code":"password"].message})]})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"mr-1",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-violet-600 bg-gray-100 border-gray-300 rounded focus:ring-violet-500 dark:focus:ring-violet-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-slate-300",id:"toggle",onChange:A}),e.jsx("label",{htmlFor:"toggle",className:"ml-2 text-sm",children:"Use Login Code"})]}),e.jsxs("button",{className:"btn bg-gray-900 text-gray-100 hover:bg-gray-800 dark:bg-gray-100 dark:text-gray-800 dark:hover:bg-white disabled:border-gray-200 dark:disabled:border-gray-700 disabled:bg-white dark:disabled:bg-gray-800 disabled:text-gray-300 dark:disabled:text-gray-600 disabled:cursor-not-allowed",disabled:l,children:[l&&e.jsx("svg",{className:"animate-spin fill-current shrink-0",width:"16",height:"16",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M8 16a7.928 7.928 0 01-3.428-.77l.857-1.807A6.006 6.006 0 0014 8c0-3.309-2.691-6-6-6a6.006 6.006 0 00-5.422 8.572l-1.806.859A7.929 7.929 0 010 8c0-4.411 3.589-8 8-8s8 3.589 8 8-3.589 8-8 8z"})}),"Sign In"]})]})]})]})]})}),e.jsxs("div",{className:"hidden md:block absolute top-0 bottom-0 right-0 md:w-1/2","aria-hidden":"true",children:[e.jsx("img",{className:"object-cover object-center w-full h-full",src:D,width:"760",height:"1024",alt:"Authentication"}),e.jsx("img",{className:"absolute top-1/4 left-0 -translate-x-1/2 ml-8 hidden lg:block",src:Z,width:"218",height:"224",alt:"Authentication decoration"})]})]})}):e.jsx(L,{})}export{z as default};
