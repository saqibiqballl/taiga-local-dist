import{j as e,v as V,w as C,L as E,x as O,y as L,z as I,A as R,D as j,B as k,r as l,u as Z,K as T}from"./index.js";import{g as U}from"./index41.js";import"./toastr.js";import"./iconify.js";import{S}from"./SingleSelectDropdown.js";import{M as G}from"./MuiDialog.js";import{V as H,a as $}from"./axios.js";import{B as q}from"./Banner.js";import{B as K}from"./index3.js";import"./chartjs-adapter-moment.esm.js";import{E as W}from"./index40.js";import{A as Y}from"./Avatar.js";import{G as P}from"./Grid.js";import"./DialogTitle.js";import"./useTheme.js";import"./Backdrop.js";import"./Modal.js";import"./resolveComponentProps.js";import"./useSlotProps.js";import"./Paper.js";import"./moment.js";import"./createSvgIcon.js";const J=({progress:s})=>e.jsxs("div",{className:"mt-5",children:[e.jsx("h2",{children:"Task Progress"}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full dark:bg-gray-700",style:{width:"300px"},children:e.jsxs("div",{className:"bg-blue-600 text-xs font-medium text-blue-100 text-center p-0.5 leading-none rounded-full",style:{width:`${s}%`},children:[s,"%"]})})]});V.register(C,E,O,L,I,R);const _=({graphData:s})=>{const a=s==null?void 0:s.labels,o=s==null?void 0:s.data,i={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{x:{grid:{display:!1},title:{display:!0,text:new Date().toLocaleString("default",{month:"long"})},ticks:{color:j().theme.colors.gray[700],autoSkip:!1}},y:{grid:{display:!1},title:{display:!0,text:"Counts"},ticks:{beginAtZero:!0,color:j().theme.colors.gray[700]}}}},d={labels:a,datasets:[{barPercentage:.5,categoryPercentage:.5,label:"Count",data:o,backgroundColor:j().theme.colors.violet[500],hoverBackgroundColor:j().theme.colors.violet[600],borderRadius:4}]};return e.jsx("div",{className:"w-full mx-auto",style:{height:"300px"},children:e.jsx(K,{options:i,data:d})})};function Q({projectAnalytics:s}){const{keywordMatches:a,topicOccurrences:o}=s,i={labels:a.map(r=>r.keyword),data:a.map(r=>r.count)},d={labels:o.map(r=>r.topic),data:o.map(r=>r.count)};return e.jsxs("div",{className:"p-3 bg-white dark:bg-gray-800 overflow-auto dark:text-slate-300 flex flex-col items-center justify-center min-h-screen",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("h3",{className:"text-md text-slate-700 dark:text-slate-100 font-semibold text-center",children:"Keyword Matches"}),e.jsx(_,{graphData:i})]}),e.jsxs("div",{className:"w-full mt-6",children:[e.jsx("h3",{className:"text-md text-slate-700 dark:text-slate-100 font-semibold text-center",children:"Topic Occurrences"}),e.jsx(_,{graphData:d})]})]})}function X({fetchedVideos:s}){return e.jsx(k,{className:"grow",children:e.jsx("div",{className:"md:sticky md:top-16 md:h-[calc(100dvh-64px)] md:overflow-x-hidden md:overflow-y-auto no-scrollbar",children:e.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-2 mx-auto mb-6",children:s.length>0?s==null?void 0:s.map((a,o)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(Y,{src:a.channelProfile.thumbnails.default.url||a.channelProfile.thumbnails.medium.url||a.channelProfile.thumbnails.high.url}),e.jsxs("div",{className:"ml-2",children:[e.jsx("h3",{className:"font-bold text-slate-900",children:a.channelProfile.title}),e.jsx("p",{className:"text-sm text-slate-500",children:a.title})]})]}),e.jsx(W,{upload:a})]},o)):e.jsx("p",{className:"text-slate-500 italic",children:"No fetched videos found"})})})})}function ee({projectsList:s}){const[a,o]=l.useState(),[i,d]=l.useState(0),[r,y]=l.useState(!1);l.useState(0);const[x,h]=l.useState(!1),[m,g]=l.useState(null),[p,w]=l.useState([]),[b,c]=l.useState(0),[B,F]=l.useState(!1),[A,te]=l.useState(""),t=new Date,[M,se]=l.useState([{label:"1 day ago",value:{start_time:new Date(t).setDate(t.getDate()),end_time:new Date(t).setDate(t.getDate()-1)}},{label:"2 days ago",value:{start_time:new Date(t).setDate(t.getDate()-1),end_time:new Date(t).setDate(t.getDate()-2)}},{label:"3 days ago",value:{start_time:new Date(t).setDate(t.getDate()-2),end_time:new Date(t).setDate(t.getDate()-3)}},{label:"4 days ago",value:{start_time:new Date(t).setDate(t.getDate()-3),end_time:new Date(t).setDate(t.getDate()-4)}},{label:"5 days ago",value:{start_time:new Date(t).setDate(t.getDate()-4),end_time:new Date(t).setDate(t.getDate()-5)}},{label:"6 days ago",value:{start_time:new Date(t).setDate(t.getDate()-5),end_time:new Date(t).setDate(t.getDate()-6)}},{label:"7 days ago",value:{start_time:new Date(t).setDate(t.getDate()-5),end_time:new Date(t).setDate(t.getDate()-6)}}]),z=async()=>{const n={daysAgo:i};y(!0),c(0);try{const f=await H.post(`${$.posts}/${a}`,n,{onUploadProgress:u=>{const v=u.total,D=u.loaded,N=Math.round(D/v*100);c(N)},onDownloadProgress:u=>{const v=u.total,D=u.loaded,N=Math.round(D/v*100);c(N)}});g(f.data.latestFetchHistory),w(f.data.fetchedVideos),c(100)}catch(f){console.error("Error fetching posts:",f),c(0)}finally{y(!1)}};return e.jsx(k,{className:"grow",children:e.jsxs(k,{className:"p-6 p-space-y-6 ",children:[e.jsx(q,{type:"error",open:B,setOpen:F,children:A}),e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-4",children:[e.jsx("h5",{className:"text-sm text-slate-700 dark:text-slate-100 font-bold mb-2",children:"Select Project"}),e.jsx(S,{label:"Select Project",options:s,selectedValue:a,onSelect:n=>{o(n)},clearable:!1})]}),e.jsx("div",{className:"col-span-8 flex justify-end text-right"}),e.jsxs("div",{className:"col-span-4",children:[e.jsx("h5",{className:"text-sm text-slate-700 dark:text-slate-100 font-bold mb-2",children:"Select Past Time"}),e.jsx(S,{label:"Select Past Time",options:M,selectedValue:i,onSelect:n=>{d(n)},clearable:!1})]})]}),r&&e.jsx(J,{progress:b}),e.jsx("footer",{className:"mt-5",children:e.jsxs(P,{container:!0,justifyContent:"space-between",children:[e.jsx(P,{item:!0,xs:6,children:m&&e.jsx("button",{"data-name":"feature_videoBuzz_vewFetchPosts",className:"btn bg-gray-900 text-gray-100 hover:bg-gray-800 dark:bg-gray-100 dark:text-gray-800 dark:hover:bg-white",onClick:()=>{h(!0)},children:"View Fetch Posts"})}),e.jsx(P,{item:!0,xs:6,style:{textAlign:"right"},children:e.jsxs("button",{"data-name":"feature_videoBuzz_startFetching",onClick:n=>{n.preventDefault(),z()},className:"btn bg-gray-900 text-gray-100 hover:bg-gray-800 dark:bg-gray-100 dark:text-gray-800 dark:hover:bg-white disabled:border-gray-200 dark:disabled:border-gray-700 disabled:bg-white dark:disabled:bg-gray-800 disabled:text-gray-300 dark:disabled:text-gray-600 disabled:cursor-not-allowed",disabled:r||!a,children:[r&&e.jsx("svg",{className:"animate-spin fill-current shrink-0",width:"16",height:"16",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M8 16a7.928 7.928 0 01-3.428-.77l.857-1.807A6.006 6.006 0 0014 8c0-3.309-2.691-6-6-6a6.006 6.006 0 00-5.422 8.572l-1.806.859A7.929 7.929 0 010 8c0-4.411 3.589-8 8-8s8 3.589 8 8-3.589 8-8 8z"})}),"Start Fetching"]})})]})}),m&&e.jsx(Q,{projectAnalytics:m}),x&&e.jsx(G,{id:"FetchedVideos-1234",open:x,setOpen:n=>h(n),title:"Fetched Posts",fullWidth:!0,maxWidth:"md",children:e.jsx(X,{fetchedVideos:p??[]})})]})})}const Pe=()=>{const s=Z(),a=s==null?void 0:s.userPermissions,o="module_videoBuzz",i="submodule_videoBuzz_fetchPosts",d=l.useMemo(()=>T(a,o,i),[a]),[r,y]=l.useState(!1),[x,h]=l.useState([]);return l.useEffect(()=>{(async()=>{const g=await U();h(g)})()},[]),l.useEffect(()=>{requestAnimationFrame(()=>{document.querySelectorAll("[data-name]").forEach(p=>{const w=p.getAttribute("data-name"),b=d.find(c=>c.id===w);b&&(b.enable||p.remove())})})},[d,r]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-6 p-space-y-6",children:[e.jsx("div",{className:"mb-8",children:e.jsx("h1",{className:"text-2xl md:text-3xl text-slate-700 dark:text-slate-100 font-bold",children:"VideoBuzz âœ¨"})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl mb-8",children:e.jsx("div",{className:"flex flex-col md:flex-row md:-mr-px",children:e.jsx(ee,{projectsList:x})})})]})})};export{Pe as default};
