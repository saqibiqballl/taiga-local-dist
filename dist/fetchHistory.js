import{j as e,V as S,r as a,C,d as _,u as F,K as P}from"./index.js";import{F as R}from"./index47.js";import{R as I}from"./index35.js";import"./iconify.js";import{d as H}from"./dayjs.min.js";import{S as A}from"./secureFetch.js";import{t as D}from"./toastr.js";import{D as E}from"./Datepicker.js";import"./index34.js";import"./popover.js";import"./floating-ui.dom.js";import"./tslib.es6.js";function M(t){const l=r=>{switch(r){case"Paid":return"text-emerald-500";case"Due":return"text-amber-500";case"Overdue":return"text-rose-500";default:return"text-slate-500"}},d=r=>{switch(r){case"Paid":return"bg-emerald-100 dark:bg-emerald-400/30 text-emerald-600 dark:text-emerald-400";case"Due":return"bg-amber-100 dark:bg-amber-400/30 text-amber-600 dark:text-amber-400";case"Overdue":return"bg-rose-100 dark:bg-rose-500/30 text-rose-500 dark:text-rose-400";default:return"bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-400"}};return e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap w-px",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"inline-flex",children:[e.jsx("span",{className:"sr-only",children:"Select"}),e.jsx("input",{id:t.id,className:"w-4 h-4 text-violet-600 bg-gray-100 border-gray-300 rounded focus:ring-violet-500 dark:focus:ring-violet-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-slate-300",type:"checkbox",onChange:t.handleClick,checked:t.isChecked})]})})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-medium text-sky-500",children:t.date})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-medium text-slate-700 dark:text-slate-100",children:t.iterations})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:`font-medium ${l(t.status)}`,children:t.keywordcounts})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-medium text-slate-700 dark:text-slate-100",children:t.topiccounts})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:`inline-flex font-medium rounded-full text-center px-2.5 py-0.5 ${d(t.status)}`,children:t.status})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-1 whitespace-nowrap w-px",children:e.jsx("div",{"data-name":"feature_socialRadar_fetchHistory_viewDetails",className:"space-x-1",children:e.jsx(S,{className:"text-violet-500",to:`/socialradar/settings/fetchhistory/${t==null?void 0:t.id}`,children:"View Details"})})})]})}function T({historyData:t,selectedItems:l}){const[d,r]=a.useState(!1),[i,c]=a.useState([]),[o,m]=a.useState([]);a.useEffect(()=>{m(t)},[t]);const h=()=>{r(!d),c(o.map(s=>s.id)),d&&c([])},x=s=>{const{id:n,checked:p}=s.target;r(!1),c([...i,n]),p||c(i.filter(u=>u!==n))};return a.useEffect(()=>{l(i)},[i]),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xs rounded-xl relative mt-3",children:[e.jsx("header",{className:"px-5 py-4",children:e.jsxs("h2",{className:"font-semibold text-slate-700 dark:text-slate-100",children:["Total ",e.jsx("span",{className:"text-slate-400 dark:text-slate-500 font-medium",children:t==null?void 0:t.length})]})}),e.jsx("div",{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full dark:text-gray-300",children:[e.jsx("thead",{className:"text-xs font-semibold uppercase text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-900/20 border-t border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap w-px",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"inline-flex",children:[e.jsx("span",{className:"sr-only",children:"Select all"}),e.jsx("input",{className:"w-4 h-4 text-violet-600 bg-gray-100 border-gray-300 rounded focus:ring-violet-500 dark:focus:ring-violet-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-slate-300",type:"checkbox",checked:d,onChange:h})]})})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"Date"})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"Target Size"})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"Keywords Count"})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"Topics Count"})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"Status"})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"Actions"})})]})}),e.jsx("tbody",{className:"text-sm divide-y divide-slate-200 dark:divide-slate-700",children:o.map(s=>e.jsx(M,{id:s._id,keywordcounts:s.keywordcounts.length,topiccounts:s.topiccounts.length,status:"Complete",iterations:s==null?void 0:s.iterations,fetchSettingId:s==null?void 0:s.fetchsettingid,date:H(s.createdAt).format("MMMM D, YYYY"),handleClick:x,isChecked:i.includes(s._id)},s._id))})]})})})]})}function z({setCheckRendered:t}){const[l,d]=a.useState(0),[r,i]=a.useState([]),[c,o]=a.useState(),[m,h]=a.useState();a.useState(!1);const[x,s]=a.useState([]),[n,p]=a.useState([]),[u,b]=a.useState(1),[j,V]=a.useState(20),[N,w]=a.useState(0),k=f=>{s([...f])},v=async()=>{var f;if((f=r[l])!=null&&f._id)try{const g=await A.post(`${_}/api/fetchhistory/getfetchhistory`,{fetchSettingId:r[l]._id,pageSize:j,page:u,from:c,to:m}),y=g.totalCount;p([...g.data]),w(Math.ceil(y/j)),t(!0)}catch{D.error("Error Occurred")}};return a.useEffect(()=>{v()},[l,r,u,j,c,m]),e.jsx("div",{className:"grow",children:e.jsxs("div",{className:"p-6 p-space-y-6 ",children:[e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{"data-name":"feature_socialRadar_fetchHistory_dropDownFilter",children:e.jsx(R,{selected:l,setSelected:d,options:r,setOptions:i})}),e.jsx("div",{"data-name":"feature_socialRadar_fetchHistory_dateFilter",className:"ml-auto flex items-center",children:e.jsx(E,{initialDate:{from:c,to:m},setFrom:o,setTo:h})})]}),n.length>0?e.jsxs(e.Fragment,{children:[e.jsx(T,{historyData:[...n],selectedItems:k}),e.jsx("div",{className:"mt-8",children:e.jsx(I,{current:u,total:N,onPageChange:b})})]}):e.jsxs("div",{className:"mt-8",children:[" ",e.jsx(C,{})]})]})})}function X(){const t=F(),l=t==null?void 0:t.userPermissions,d="module_socialRadar",r="submodule_socialRadar_fetchHistory",i=a.useMemo(()=>P(l,d,r),[l]),[c,o]=a.useState(!1);return a.useEffect(()=>{requestAnimationFrame(()=>{document.querySelectorAll("[data-name]").forEach(x=>{const s=x.getAttribute("data-name"),n=i.find(p=>p.id===s);n&&(n.enable||x.remove())})})},[i,c]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-6 p-space-y-6",children:[e.jsx("div",{className:"mb-8",children:e.jsx("h1",{className:"text-2xl md:text-3xl text-slate-700 dark:text-slate-100 font-bold",children:"Social Buzz Fetch History âœ¨"})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl mb-8",children:e.jsx("div",{className:"flex flex-col md:flex-row md:-mr-px",children:e.jsx(z,{setCheckRendered:o})})})]})})}export{X as default};
