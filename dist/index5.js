import{j as e,V as y,r as n,v as w,aD as re,G as R,H as ie,P as A,L as E,aE as de,z as C,aF as oe,x as $,w as B,y as O,A as F,D as c,E as ne,Z as ce,u as xe,aG as me,K as pe,W as S,X as T,C as ue,B as g,s as V}from"./index.js";import{c as _,d as he}from"./constants.js";import{d as be}from"./dayjs.min.js";import"./chartjs-adapter-moment.esm.js";import{B as fe,P as je,L as ge}from"./index3.js";import{t as ye}from"./toastr.js";import{B as ve}from"./Backdrop.js";import{G as j}from"./Grid.js";import{T as Ne,a as ke}from"./Tabs.js";import"./createSvgIcon2.js";import"./createSvgIcon.js";import"./resolveComponentProps.js";import"./moment.js";import"./useTheme.js";import"./useSlotProps.js";import"./KeyboardArrowRight.js";function we({data:s}){return e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xs rounded-xl relative",children:[e.jsx("header",{className:"px-5 py-4",children:e.jsxs("h2",{className:"font-semibold text-slate-700 dark:text-slate-100",children:["All Feeds"," ",e.jsxs("span",{className:"text-slate-400 dark:text-slate-500 font-medium",children:["(",s[0].url.length,")"]})]})}),e.jsx("div",{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full dark:text-gray-300",children:[e.jsx("thead",{className:"text-xs font-semibold uppercase text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-900/20 border-t border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"url"})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left"})})]})}),e.jsx("tbody",{className:"text-sm divide-y divide-slate-200 dark:divide-slate-700",children:s[0].url.map((a,d)=>e.jsx("tr",{children:e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-left",children:e.jsx(y,{to:a,target:"_blank",children:a})})})},d))})]})})})]})}function Ce({storyList:s}){return n.useEffect(()=>{},[s]),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xs rounded-xl relative",children:[e.jsx("header",{className:"px-5 py-4",children:e.jsxs("h2",{className:"font-semibold text-slate-700 dark:text-slate-100",children:["Latest Stories"," ",e.jsxs("span",{className:"text-slate-400 dark:text-slate-500 font-medium",children:["(",s.length,")"]})]})}),e.jsx("div",{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full dark:text-gray-300",children:[e.jsx("thead",{className:"text-xs font-semibold uppercase text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-900/20 border-t border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"Title"})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"Publication Date"})})]})}),e.jsx("tbody",{className:"text-sm divide-y divide-slate-200 dark:divide-slate-700",children:s.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 ",children:e.jsx("div",{className:"text-left",children:e.jsx(y,{to:a.link,target:"_blank",children:a.title})})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-left font-medium text-emerald-500",children:be(a.pubDate).format("MM/DD/YYYY")})})]}))})]})})})]})}function Se({dataList:s}){return n.useEffect(()=>{},[s]),e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-xs rounded-xl relative",children:[e.jsx("header",{className:"px-5 py-4",children:e.jsxs("h2",{className:"font-semibold text-slate-700 dark:text-slate-100",children:["Collections"," ",e.jsxs("span",{className:"text-slate-400 dark:text-slate-500 font-medium",children:["(",s.length,")"]})]})}),e.jsx("div",{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full dark:text-gray-300",children:[e.jsx("thead",{className:"text-xs font-semibold uppercase text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-900/20 border-t border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"Name"})}),e.jsx("th",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-left",children:"Sources"})})]})}),e.jsx("tbody",{className:"text-sm divide-y divide-slate-200 dark:divide-slate-700",children:s.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 ",children:e.jsx("div",{className:"text-left",children:e.jsx(y,{to:a.name,target:"_blank",children:a.name})})}),e.jsx("td",{className:"px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap",children:e.jsx("div",{className:"text-left font-medium text-emerald-500",children:a.szSources})})]}))})]})})})]})}w.register(re,R,ie,A,E,de,C,oe,$,B);w.register(B,E,$,O,C,F);const Te=({chartData:s})=>{var i;const a={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{callbacks:{title:o=>s[o[0].dataIndex]}}},scales:{x:{title:{display:!0,text:"Feeds vs. Posts"},grid:{display:!1},ticks:{color:c().theme.colors.gray[700],autoSkip:!1}},y:{grid:{display:!1},title:{display:!0,text:"Counts"},ticks:{beginAtZero:!0,color:c().theme.colors.gray[700]}}}},d={labels:s==null?void 0:s.labels,datasets:[{barPercentage:.5,categoryPercentage:.5,label:"Comparison",data:(i=s==null?void 0:s.datasets[0])==null?void 0:i.data,backgroundColor:c().theme.colors.violet[500],hoverBackgroundColor:c().theme.colors.violet[600],borderRadius:4}]};return e.jsx("div",{className:"flex justify-center items-center h-[305px]",children:e.jsx(fe,{data:d,options:a})})},_e=Te;w.register(ne,C,F);const Pe=({chartData:s})=>{var o;const a=[c().theme.colors.violet[500],c().theme.colors.red[500],c().theme.colors.yellow[500]],d={labels:s==null?void 0:s.labels,datasets:[{label:"Posts",data:(o=s==null?void 0:s.datasets[0])==null?void 0:o.data,backgroundColor:a,hoverBackgroundColor:a.map(x=>`${x}B3`),borderWidth:0}]},i={responsive:!0,plugins:{legend:{position:"top"},tooltip:{callbacks:{label:function(x){const u=x.label||"",v=x.raw||0;return`${u}: ${v}`}}}}};return e.jsx("div",{className:"flex justify-center items-center h-[305px]",children:e.jsx(je,{data:d,options:i})})},Le=Pe;w.register(B,E,A,R,O,C,F);const Ee=({chartData:s})=>{var i;const a={labels:s==null?void 0:s.labels,datasets:[{label:"Total Posts",data:(i=s==null?void 0:s.datasets[0])==null?void 0:i.data,borderColor:c().theme.colors.violet[500],backgroundColor:c().theme.colors.violet[100],fill:!0,borderWidth:2,pointRadius:4,pointBackgroundColor:c().theme.colors.violet[500],pointHoverRadius:6,tension:.3}]},d={responsive:!0,plugins:{tooltip:{callbacks:{label:o=>{var x,u;return o.dataIndex===3?`${(x=o.dataset)==null?void 0:x.label}: ${o.raw} (Last week)`:`${(u=o.dataset)==null?void 0:u.label}: ${o.raw}`}}}},scales:{x:{grid:{display:!1},title:{display:!0,text:"Weeks"}},y:{grid:{display:!1},title:{display:!0,text:"Number of Posts"},beginAtZero:!0}}};return e.jsx("div",{className:"flex justify-center items-center h-[305px]",children:e.jsx(ge,{data:a,options:d})})},Be=Ee,Fe=V(s=>e.jsx(Ne,{...s,TabIndicatorProps:{children:e.jsx("span",{className:"MuiTabs-indicatorSpan"})}}))({"& .MuiTabs-indicator":{display:"flex",justifyContent:"center",backgroundColor:"transparent"},"& .MuiTabs-indicatorSpan":{width:"100%",backgroundColor:"#6366f1"}}),P=V(s=>e.jsx(ke,{disableRipple:!0,...s}))(({theme:s})=>({fontWeight:s.typography.fontWeightRegular,fontSize:s.typography.pxToRem(15),marginRight:s.spacing(1),color:"#64748b",textTransform:"uppercase","&.Mui-selected":{color:"#6366f1"}}));function L(s){const{children:a,value:d,index:i,...o}=s;return e.jsx("div",{role:"tabpanel",hidden:d!==i,id:`simple-tabpanel-${i}`,"aria-labelledby":`simple-tab-${i}`,...o,children:d===i&&e.jsx(g,{sx:{p:3},children:e.jsx(e.Fragment,{children:a})})})}function Xe(){const{id:s}=ce(),a=xe(),d=a==null?void 0:a.userPermissions,i="module_mediaCloud",o="submodule_mediaCloud_sourcesView",x="submodule_mediaCloud_search",u=n.useMemo(()=>me(d,i,x),[d]),v=pe(d,i,o),[M,W]=n.useState(!1);n.useEffect(()=>{requestAnimationFrame(()=>{document.querySelectorAll("[data-name]").forEach(m=>{const b=m.getAttribute("data-name"),p=v.find(f=>f.id===b);p&&(p.enable||m.remove())})})},[v,M]);const[N,Y]=n.useState(0),z=(l,r)=>{Y(r)},[U,G]=n.useState("_"),[t,H]=n.useState(),[Z,q]=n.useState([]),[K,X]=n.useState([]),[J,Q]=n.useState([]),[k,D]=n.useState({}),[ee,h]=n.useState(!1);n.useEffect(()=>{I()},[]);const I=async()=>{h(!0);try{const l={id:s},r=await S.post(`${T.sources}/getDetails`,l);if(r.status==200){const b=r.data.total;H(r.data.source),G(r.data.storyPerWeek),q(r.data.feeds),X(r.data.storyList),Q(r.data.collections)}const m=await S.post(`${T.sources}/coverageOverTime`,l);m.status==200&&D(m.data.data),h(!1)}catch(l){ye.error(l.response.data.message),h(!1)}},se=async()=>{h(!0);try{const l={searchValue,from:new Date(from),to:new Date(to)},r=await S.post(`${T.sources}/getCSVData`,l);r.status==200&&ae(r.data.source),h(!1)}catch{h(!1)}},te=l=>{if(l.length===0)return"";const r=Object.keys(l[0]).join(",")+`
`,m=l.map(b=>Object.values(b).map(f=>typeof f=="string"&&f.includes(",")?`"${f}"`:f).join(",")).join(`
`);return r+m},ae=l=>{const r=te(l),m=new Blob([r],{type:"text/csv"}),b=URL.createObjectURL(m),p=document.createElement("a");p.href=b,p.download="data.csv",document.body.appendChild(p),p.click(),document.body.removeChild(p)},le=[{title:"STORIES PER WEEK",content:U||"_"},{title:"PUBLICATION COUNTRY",content:_(t==null?void 0:t.pub_country)||"_"},{title:"PUBLICATION STATE",content:_(t==null?void 0:t.pub_state)||"_"},{title:"MEDIA TYPE",content:_(t==null?void 0:t.media_type)||"_"}];return e.jsxs(e.Fragment,{children:[e.jsx(ve,{sx:{zIndex:l=>l.zIndex.drawer+1},open:ee,children:e.jsx(ue,{})}),e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-9xl mx-auto",children:[e.jsxs("div",{className:"sm:flex sm:justify-between sm:items-center mb-8",children:[e.jsx("div",{className:"mb-4 sm:mb-0",children:e.jsxs("h1",{className:"text-2xl md:text-3xl text-slate-700 dark:text-slate-100 font-bold",children:[t==null?void 0:t.label," ✨"]})}),e.jsx("div",{className:"grid grid-flow-col sm:auto-cols-max justify-start sm:justify-end gap-2",children:u.enable&&e.jsxs("button",{className:"btn bg-gray-900 text-gray-100 hover:bg-gray-800 dark:bg-gray-100 dark:text-gray-800 dark:hover:bg-white",onClick:l=>{se()},children:[e.jsx(he,{}),e.jsx(y,{to:"/mediacloud/search",className:"hidden xs:block ml-2",children:"Search Content"})]})})]}),e.jsx(j,{"data-name":"feature_mediaCloud_sourcesView_sourceInfo",container:!0,spacing:2,children:le.map((l,r)=>e.jsx(j,{item:!0,md:3,children:e.jsx("div",{className:"col-span-full xl:col-span-6 2xl:col-span-4 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:"flex flex-col h-full p-5",children:e.jsxs("div",{className:"grow",children:[e.jsx("header",{className:"flex items-center mb-4",children:e.jsx("h3",{className:"text-md text-slate-700 dark:text-slate-100 font-semibold",children:l.title})}),e.jsx("div",{className:"text-sm",children:l.content})]})})})},r))}),e.jsxs(g,{className:"mt-3",children:[e.jsx("label",{className:"mr-3 text-md font-bold text-slate-700",children:"Home Page"}),e.jsx(y,{to:t!=null&&t.domain_name?"//"+(t==null?void 0:t.domain_name):"#",target:"_blank",children:t!=null&&t.domain_name?t==null?void 0:t.domain_name:"#"})]}),e.jsxs(g,{className:"mt-3",children:[e.jsx("label",{className:"mr-3 text-md font-bold text-slate-700",children:"Category"}),t==null?void 0:t.category.map((l,r)=>e.jsx("span",{className:"bg-violet-100 text-violet-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-full dark:bg-violet-900 dark:text-violet-300",children:l},r))]}),e.jsxs(g,{className:"mt-5",children:[e.jsx(g,{children:e.jsxs(Fe,{value:N,onChange:z,"aria-label":"styled tabs example",children:[e.jsx(P,{"data-name":"feature_mediaCloud_sourcesView_connectionList",label:"Connection List"}),e.jsx(P,{"data-name":"feature_mediaCloud_sourcesView_coverageOverTime",label:"Coverage Over Time"}),e.jsx(P,{"data-name":"feature_mediaCloud_sourcesView_listFeed",label:"List Feeds"})]})}),e.jsx(L,{value:N,index:0,children:e.jsxs(j,{container:!0,spacing:6,children:[e.jsx(j,{item:!0,sm:6,children:e.jsx(Se,{dataList:J})}),e.jsx(j,{item:!0,sm:6,children:e.jsx(Ce,{storyList:K})})]})}),e.jsx(L,{value:N,index:1,children:Object.keys(k).length>0&&e.jsxs("div",{className:"bg-white p-4 rounded-xl",children:[e.jsxs("div",{className:"flex flex-col col-span-full sm:col-span-6 xl:col-span-4 bg-white dark:bg-gray-800 shadow-xs rounded-xl",children:[e.jsx("header",{className:"px-5 py-4 border-b border-gray-100 dark:border-gray-700/60",children:e.jsx("h2",{className:"font-semibold text-gray-800 dark:text-gray-100",children:"Total Feeds vs. Posts"})}),e.jsx(_e,{chartData:k.barData})]}),e.jsxs("div",{className:"flex flex-col col-span-full sm:col-span-6 xl:col-span-4 bg-white dark:bg-gray-800 shadow-xs rounded-xl",children:[e.jsx("header",{className:"px-5 py-4 border-b border-gray-100 dark:border-gray-700/60",children:e.jsx("h2",{className:"font-semibold text-gray-800 dark:text-gray-100",children:"Last Week’s Posts vs. Total Posts"})}),e.jsx(Le,{chartData:k.pieData})]}),e.jsxs("div",{className:"flex flex-col col-span-full sm:col-span-6 xl:col-span-4 bg-white dark:bg-gray-800 shadow-xs rounded-xl",children:[e.jsx("header",{className:"px-5 py-4 border-b border-gray-100 dark:border-gray-700/60",children:e.jsx("h2",{className:"font-semibold text-gray-800 dark:text-gray-100",children:"Posts Over Time"})}),e.jsx(Be,{chartData:k.lineData})]})]})}),e.jsx(L,{value:N,index:2,children:e.jsx(we,{setCheckListRendered:W,data:Z,reloadData:I})})]})]})]})}export{Xe as default};
